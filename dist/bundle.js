(()=>{"use strict";class t{static randomFont(){const t=["Arial","Verdana","Helvetica","Tahoma","Trebuchet MS","Times New Roman","Georgia","Garamond","Courier New","Brush Script MT"];return t[Math.floor(Math.random()*t.length)]}static randomChar(){return String.fromCharCode(65+Math.floor(26*Math.random()))}static randomHexColor(){return"#"+Math.floor(16777215*Math.random()).toString(16)}static isUserUsingMobile(){let t=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);if(!t){let i=window.screen.width,e=window.screen.height;t=i<768||e<768}if(t||(t="ontouchstart"in window||navigator.maxTouchPoints>0),!t){let i=document.getElementsByTagName("body")[0];t=-1!==window.getComputedStyle(i).getPropertyValue("content").indexOf("mobile")}return t}}class i{constructor(t,i,e,s,a){this.x=t,this.y=i,this.dx=e,this.dy=s,this.radius=a}getX(){return this.x}getY(){return this.y}getRadius(){return this.radius}draw(t){t.beginPath(),t.arc(this.x,this.y,this.radius,0,2*Math.PI),t.fillStyle="black",t.fill(),t.closePath()}move(t,i){i.isKeyPressed("ArrowUp")&&(this.y=Math.max(this.y-this.dy,this.radius)),i.isKeyPressed("ArrowDown")&&(this.y=Math.min(this.y+this.dy,t.height-this.radius)),i.isKeyPressed("ArrowLeft")&&(this.x=Math.max(this.x-this.dx,this.radius)),i.isKeyPressed("ArrowRight")&&(this.x=Math.min(this.x+this.dx,t.width-this.radius))}handleCollisionWithWeapon(t){this.radius+=t.getSize()/10}isCollidingWithWall(t){return this.x-this.radius<=0||this.x+this.radius>=t.width||this.y-this.radius<=0||this.y+this.radius>=t.height}}const e=class{constructor(t){this.keys=t}setupTouchListeners(){window.addEventListener("touchstart",(t=>this.handleTouchMoveOrStart(t)),{passive:!1}),window.addEventListener("touchmove",(t=>this.handleTouchMoveOrStart(t)),{passive:!1}),window.addEventListener("touchend",(t=>this.handleTouchEnd(t)))}handleTouchMoveOrStart(t){const i=t.touches[0];this.isJoystickTouch(i)&&(t.preventDefault(),this.moveJoystickBall(i))}handleTouchEnd(t){const i=t.changedTouches[0];this.isJoystickTouch(i)&&(t.preventDefault(),this.resetJoystickBall())}isJoystickTouch(t){return t.target instanceof HTMLElement&&"joyStickBall"===t.target.id}moveJoystickBall(t){const i=document.getElementById("joyStickBall"),e=document.getElementById("joyStickRing"),{left:s,top:a,width:h,height:o}=e.getBoundingClientRect(),n=s+h/2,r=a+o/2,l=t.clientX-n,d=t.clientY-r;i.style.left=`${l}px`,i.style.top=`${d}px`,this.updateKeysBasedOnAngle(l,d)}updateKeysBasedOnAngle(t,i){const e=(360-Math.atan2(i,t)*(180/Math.PI)+22.5)%360,s=Math.floor(e/45);this.resetKeys(),({0:["ArrowRight"],1:["ArrowRight","ArrowUp"],2:["ArrowUp"],3:["ArrowUp","ArrowLeft"],4:["ArrowLeft"],5:["ArrowLeft","ArrowDown"],6:["ArrowDown"],7:["ArrowDown","ArrowRight"]}[s]||[]).forEach((t=>this.keys[t]=!0))}resetJoystickBall(){const t=document.getElementById("joyStickBall");t.style.left="auto",t.style.top="auto",this.resetKeys()}resetKeys(){Object.keys(this.keys).forEach((t=>this.keys[t]=!1))}};class s{constructor(){this.keys={ArrowUp:!1,ArrowDown:!1,ArrowLeft:!1,ArrowRight:!1},this.altKeys={w:"ArrowUp",s:"ArrowDown",a:"ArrowLeft",d:"ArrowRight"},this.setupEventListeners()}setupEventListeners(){t.isUserUsingMobile()?(this.joystick=new e(this.keys),this.joystick.setupTouchListeners()):(window.addEventListener("keydown",(t=>this.handleKeyDownUp(t))),window.addEventListener("keyup",(t=>this.handleKeyDownUp(t))))}handleKeyDownUp(t){let i=t.key;i.toLocaleLowerCase()in this.altKeys&&(i=this.altKeys[i.toLocaleLowerCase()]),i in this.keys&&(t.preventDefault(),this.keys[i]="keydown"===t.type)}isKeyPressed(t){return!!this.keys[t]}resetKeys(){for(let t in this.keys)this.keys[t]=!1}}class a{constructor(i){let e=Math.floor(20*Math.random())+10;this.font=`${e}px ${t.randomFont()}`,this.letter=t.randomChar(),this.color=t.randomHexColor(),i.font=this.font,i.fillStyle=this.color;let s=i.measureText(this.letter);this.width=s.actualBoundingBoxLeft+s.actualBoundingBoxRight,this.height=s.actualBoundingBoxAscent+s.actualBoundingBoxDescent,this.startingLoc=a.randomStartingLoc(),[this.x,this.y,this.dx,this.dy]=this.randomTrajectory(this.startingLoc,i.canvas),this.speed=Math.floor(2*Math.random())+1}static randomStartingLoc(){return a.startingLocs[Math.floor(Math.random()*a.startingLocs.length)]}randomTrajectory(t,i){let e,s,a,h;switch(t){case"top":e=Math.floor(Math.random()*i.width),s=0-this.height,a=2*Math.random()-1,h=Math.random();break;case"bottom":e=Math.floor(Math.random()*i.width),s=i.height,a=2*Math.random()-1,h=-Math.random();break;case"left":e=0-this.width,s=Math.floor(Math.random()*i.height),a=Math.random(),h=2*Math.random()-1;break;case"right":e=i.width,s=Math.floor(Math.random()*i.height),a=-Math.random(),h=2*Math.random()-1;break;default:throw new Error("Invalid starting location")}return[e,s,a,h]}getSize(){return this.width+this.height/2}draw(t){t.font=this.font,t.fillStyle=this.color,t.fillText(this.letter,this.x,this.y)}move(){this.x+=this.dx*this.speed,this.y+=this.dy*this.speed}hasCollidedWithBall(t){const i=Math.abs(t.getX()-this.x-this.width/2),e=Math.abs(t.getY()-this.y-this.height/2);return!(i>this.width/2+t.getRadius())&&(!(e>this.height/2+t.getRadius())&&(i<=this.width/2||(e<=this.height/2||Math.pow(i-this.width/2,2)+Math.pow(e-this.height/2,2)<=Math.pow(t.getRadius(),2))))}isOutOfBounds(t){return this.x+this.width<0||this.x>t.width||this.y+this.height<0||this.y>t.height}isTrajectoryComplete(t){switch(this.startingLoc){case"top":return this.y>t.height;case"bottom":return this.y+this.height<0;case"left":return this.x>t.width;case"right":return this.x+this.width<0;default:throw new Error("Invalid starting location")}}}a.startingLocs=["top","bottom","left","right"];class h{constructor(t){this.canvas=document.getElementById(t),this.ctx=this.canvas.getContext("2d"),this.ctx.textBaseline="top",this.running=!1,this.animationFrameId=null,this.inputHandler=new s,this.difficultySlider=document.getElementById("difficultySlider"),this.difficulty=parseInt(this.difficultySlider.value),this.difficultySlider.addEventListener("input",(()=>this.difficulty=parseInt(this.difficultySlider.value))),this.ball=new i(this.canvas.width/2,this.canvas.height/2,2,2,2*this.difficulty),this.weapons=[]}clearCanvas(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)}gameLoop(){if(this.running){Math.random()<this.difficulty/100&&this.weapons.push(new a(this.ctx)),this.ball.move(this.canvas,this.inputHandler);for(let t of this.weapons)t.move();this.weapons=this.weapons.filter((t=>!(t.isTrajectoryComplete(this.canvas)||t.hasCollidedWithBall(this.ball)&&(this.ball.handleCollisionWithWeapon(t),1)))),this.clearCanvas(),this.ball.draw(this.ctx);for(let t of this.weapons)t.draw(this.ctx);this.ball.isCollidingWithWall(this.canvas)?this.animationFrameId=requestAnimationFrame((()=>this.gameOver())):this.animationFrameId=requestAnimationFrame((()=>this.gameLoop()))}}start(){this.clearCanvas(),this.running=!0,this.gameLoop()}restartGame(){const t=document.querySelector(".fsModal");t&&t.remove(),this.clearCanvas(),this.inputHandler.resetKeys(),this.ball=new i(this.canvas.width/2,this.canvas.height/2,2,2,2*this.difficulty),this.weapons=[],this.start()}gameOver(){const t=document.createElement("div");t.classList.add("fsModal"),t.innerHTML='\n            <div class="modalContent">\n                <h1 class="gameOver">Game Over</h1>\n                <button class="controlButton">Restart</button>\n            </div>\n        ';const i=t.querySelector(".controlButton");i&&i.addEventListener("click",this.restartGame.bind(this)),document.body.appendChild(t)}stop(){this.running=!1,this.animationFrameId&&cancelAnimationFrame(this.animationFrameId)}}if(t.isUserUsingMobile()){document.getElementById("joyStickContainer").style.display="block";const t=document.getElementById("gameCanvas"),i=t.getContext("2d");i.font="30px Arial",i.fillStyle="black",i.textAlign="center",i.fillText("Tap on Start",t.width/2,t.height/2-20),i.fillText("to use JoyStick",t.width/2,t.height/2+20)}let o=null;window.main=function(){o&&(o.stop(),o=null),o=new h("gameCanvas"),o.start()}})();
//# sourceMappingURL=bundle.js.map